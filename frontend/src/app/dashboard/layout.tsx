'use client'
import { assets } from '@/assets/assets'
import React, { useState, useEffect } from 'react'
import Image from 'next/image';

export default function DashboardLayout({ children }: {children: React.ReactNode }) {
  const [active, setActive] = useState(0);
  const [darkMode, setDarkMode] = useState(false);

  // Initialize dark mode from localStorage or system preference
  useEffect(() => {
    const savedMode = localStorage.getItem('darkMode');
    if (savedMode !== null) {
      setDarkMode(savedMode === 'true');
    } else {
      setDarkMode(window.matchMedia('(prefers-color-scheme: dark)').matches);
    }
  }, []);

  // Apply dark mode class to document and save preference
  useEffect(() => {
    if (darkMode) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
    localStorage.setItem('darkMode', darkMode.toString());
  }, [darkMode]);

  const toggleTheme = () => {
    setDarkMode(!darkMode);
  };

  const features = [
    {
      icon: (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9.42105 18.0001H7C5.89543 18.0001 5 17.1047 5 16.0001V9.91999C5 9.33614 5.25513 8.78144 5.69842 8.40148L10.6984 4.11576C11.4474 3.47378 12.5526 3.47378 13.3016 4.11576L18.3016 8.40148C18.7449 8.78144 19 9.33614 19 9.91999V16.0001C19 17.1047 18.1046 18.0001 17 18.0001H14.5789M9.42105 18.0001V12.5001C9.42105 11.6717 10.0926 11.0001 10.9211 11.0001H13.0789C13.9074 11.0001 14.5789 11.6717 14.5789 12.5001V18.0001M9.42105 18.0001H14.5789" stroke="currentColor" strokeWidth="1.3"/>
              </svg>),
      text: 'Dashboard'
    },
    {
      icon: (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="path-1-outside-1_72_604" maskUnits="userSpaceOnUse" x="3" y="3" width="18" height="18" fill="black"><rect fill="white" x="3" y="3" width="18" height="18"/><path fillRule="evenodd" clipRule="evenodd" d="M12 19C15.866 19 19 15.866 19 12C19 8.13401 15.866 5 12 5C8.13401 5 5 8.13401 5 12C5 13.5067 5.47605 14.9023 6.28595 16.0444C6.31827 16.09 6.33088 16.1468 6.31994 16.2016L5.94231 18.0927C5.9127 18.2409 6.05191 18.3671 6.19655 18.3232L7.93803 17.7944C7.99634 17.7767 8.05944 17.7866 8.11007 17.8205C9.22258 18.5655 10.5605 19 12 19Z"/></mask>
                <path d="M7.93803 17.7944L8.31578 19.0383L7.93803 17.7944ZM8.11007 17.8205L7.38674 18.9007L8.11007 17.8205ZM5.94231 18.0927L4.66748 17.8381L5.94231 18.0927ZM6.19655 18.3232L5.8188 17.0793L6.19655 18.3232ZM6.28595 16.0444L7.3464 15.2925L6.28595 16.0444ZM17.7 12C17.7 15.148 15.148 17.7 12 17.7V20.3C16.584 20.3 20.3 16.584 20.3 12H17.7ZM12 6.3C15.148 6.3 17.7 8.85198 17.7 12H20.3C20.3 7.41604 16.584 3.7 12 3.7V6.3ZM6.3 12C6.3 8.85198 8.85198 6.3 12 6.3V3.7C7.41604 3.7 3.7 7.41604 3.7 12H6.3ZM7.3464 15.2925C6.68722 14.3629 6.3 13.2286 6.3 12H3.7C3.7 13.7849 4.26488 15.4417 5.22549 16.7964L7.3464 15.2925ZM7.21713 18.3473L7.59477 16.4562L5.04511 15.9471L4.66748 17.8381L7.21713 18.3473ZM7.56028 16.5505L5.8188 17.0793L6.5743 19.5671L8.31578 19.0383L7.56028 16.5505ZM12 17.7C10.826 17.7 9.73858 17.3465 8.8334 16.7404L7.38674 18.9007C8.70658 19.7845 10.2951 20.3 12 20.3V17.7ZM8.31578 19.0383C7.99195 19.1366 7.65201 19.0784 7.38674 18.9007L8.8334 16.7404C8.46686 16.4949 8.00073 16.4167 7.56028 16.5505L8.31578 19.0383ZM4.66748 17.8381C4.44547 18.9498 5.48953 19.8965 6.5743 19.5671L5.8188 17.0793C6.61429 16.8377 7.37994 17.532 7.21713 18.3473L4.66748 17.8381ZM5.22549 16.7964C5.05595 16.5573 4.98434 16.2514 5.04511 15.9471L7.59477 16.4562C7.67742 16.0423 7.5806 15.6228 7.3464 15.2925L5.22549 16.7964Z" fill="currentColor" mask="url(#path-1-outside-1_72_604)"/><circle cx="8.5" cy="12" r="0.875" fill="currentColor"/><circle cx="12" cy="12" r="0.875" fill="currentColor"/><circle cx="15.5" cy="12" r="0.875" fill="currentColor"/>
             </svg>),
      text: 'Chat'
    },
    {
      icon: (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="8" stroke="currentColor" strokeWidth="1.3"/>
                <path d="M10.64 10.4914L9.23262 14.2443C9.17233 14.405 9.32933 14.562 9.49011 14.5018L13.243 13.0944C13.2971 13.0741 13.3398 13.0315 13.36 12.9774L14.7674 9.22448C14.8277 9.06371 14.6707 8.9067 14.5099 8.96699L10.757 10.3743C10.7029 10.3946 10.6602 10.4373 10.64 10.4914Z" stroke="currentColor" strokeWidth="1.2"/>
              </svg>),
      text: 'Discover'
    },
    {
      icon: (<svg width="16" height="12" viewBox="0 0 16 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 11.3293C5.66667 9.9593 6.8 7.21924 10 7.21924C13.2 7.21924 14.3333 9.9593 14.5 11.3293" stroke="currentColor" strokeWidth="1.3" strokeLinecap="round"/><ellipse cx="10.0002" cy="3.22656" rx="1.8" ry="1.8789" stroke="currentColor" strokeWidth="1.3"/>
                <path d="M1 8.00421C1.1098 7.1016 1.85647 5.29639 3.96471 5.29639C5.5 5.29639 6.4 6.59501 6.4 6.59501" stroke="currentColor" strokeWidth="1.2" strokeLinecap="round"/><path d="M4.01758 1.5C4.53996 1.50004 4.99977 1.94827 5 2.54688C5 3.1457 4.54009 3.59469 4.01758 3.59473C3.49504 3.59473 3.03516 3.14573 3.03516 2.54688C3.03539 1.94825 3.49517 1.5 4.01758 1.5Z" stroke="currentColor"/>
              </svg>),
      text: 'Community',
      mode: (<span className='bg-[#172B85] rounded-xl text-white font-bold px-3 ml-9'>2</span>)        
    },
    {
      icon: (<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.75617 13.0919H2.5562C1.65883 13.0919 1.0062 12.3255 1.0062 11.474V3.89523C0.924624 2.95853 1.65883 2.19214 2.5562 2.19214H12.1825C13.0798 2.19214 13.7325 2.95853 13.7325 3.81007V7.81233" stroke="currentColor" strokeWidth="1.3" strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/>
                <path d="M4.1875 3.38432V1" stroke="currentColor" strokeWidth="1.3" strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/><path d="M10.5508 3.38432V1" stroke="currentColor" strokeWidth="1.3" strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/><path d="M12.2639 15.5614C14.3814 15.5614 16.0981 13.7695 16.0981 11.5591C16.0981 9.34876 14.3814 7.55688 12.2639 7.55688C10.1463 7.55688 8.42969 9.34876 8.42969 11.5591C8.42969 13.7695 10.1463 15.5614 12.2639 15.5614Z" stroke="currentColor" strokeWidth="1.3" strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/><path d="M12.2637 9.9248V11.5592L13.161 12.4107" stroke="currentColor" strokeWidth="1.1" strokeMiterlimit="10" strokeLinecap="round" strokeLinejoin="round"/>
              </svg>),
      text: 'Events'
    },
    {
      icon: (<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fillRule="evenodd" clipRule="evenodd" d="M6.09685 1.5788C5.4122 1.7597 4.75839 2.05319 4.16329 2.45082C3.10381 3.15875 2.27804 4.16495 1.79042 5.34218C1.30279 6.51942 1.17521 7.81481 1.4238 9.06456C1.67239 10.3143 2.28599 11.4623 3.187 12.3633C4.08802 13.2643 5.23598 13.8779 6.48573 14.1265C7.73547 14.3751 9.03087 14.2475 10.2081 13.7599C11.3853 13.2722 12.3915 12.4465 13.0995 11.387C13.4971 10.7919 13.7906 10.1381 13.9715 9.45343C13.9841 9.40567 13.9796 9.3805 13.9757 9.36639C13.9708 9.34833 13.9575 9.31678 13.9213 9.27756C13.8431 9.19282 13.6876 9.10766 13.4852 9.10766H9.63482C9.38355 9.47341 9.03152 9.75868 8.62116 9.92865C8.20167 10.1024 7.74007 10.1479 7.29474 10.0593C6.84941 9.97071 6.44035 9.75206 6.11929 9.431C5.79822 9.10993 5.57957 8.70087 5.49099 8.25554C5.40241 7.81021 5.44787 7.34861 5.62163 6.92912C5.7916 6.51877 6.07688 6.16673 6.44262 5.91546V2.06505C6.44262 1.86272 6.35747 1.70718 6.27272 1.62901C6.2335 1.59283 6.20195 1.57945 6.1839 1.57456C6.16978 1.57073 6.14462 1.56618 6.09685 1.5788ZM5.76476 0.321931C6.83268 0.039763 7.74262 0.960478 7.74262 2.06505V6.22539C7.74262 6.54932 7.45876 6.79977 7.18942 6.97973C7.02567 7.08915 6.89804 7.24466 6.82267 7.42661C6.74731 7.60856 6.72759 7.80877 6.76601 8.00192C6.80443 8.19508 6.89927 8.3725 7.03852 8.51176C7.17778 8.65102 7.35521 8.74585 7.54836 8.78427C7.74152 8.82269 7.94173 8.80297 8.12368 8.72761C8.30562 8.65224 8.46114 8.52462 8.57055 8.36087C8.75052 8.09153 9.00096 7.80766 9.3249 7.80766H13.4852C14.5898 7.80766 15.5105 8.7176 15.2284 9.78552C15.011 10.6083 14.6582 11.3941 14.1804 12.1092C13.3296 13.3825 12.1204 14.3749 10.7056 14.9609C9.29081 15.5469 7.73403 15.7003 6.23211 15.4015C4.73019 15.1028 3.35059 14.3653 2.26776 13.2825C1.18494 12.1997 0.447526 10.8201 0.148776 9.31817C-0.149975 7.81625 0.00335473 6.25947 0.589375 4.84469C1.1754 3.42991 2.16779 2.22068 3.44105 1.36991C4.15623 0.892046 4.94198 0.539326 5.76476 0.321931Z" fill="currentColor"/>
              </svg>),
      text: 'Analytics'
    },
    {
      icon: (<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8Z" fill="#2266BE"/>
                <path d="M8 14.3379C8 14.5036 8.13442 14.6386 8.29993 14.6311C9.95129 14.5565 11.5197 13.8677 12.6937 12.6937C13.9385 11.4489 14.6379 9.76051 14.6379 8.00004C14.6379 6.23957 13.9385 4.5512 12.6937 3.30636C11.5197 2.1324 9.95129 1.44358 8.29993 1.36895C8.13442 1.36147 8 1.49649 8 1.66218L8 8.00004L8 14.3379Z" fill="white"/>
            </svg>),
      text: 'Light Mode',
      mode: (
        <div className= {`${darkMode ? 'bg-[#0ce617]' : 'bg-[#0F1A4F]'} w-10 h-5 rounded-full flex relative ml-6 items-center`}>
              <div  onClick={toggleTheme} className={`bg-[#FFFFFF] w-5 h-5 rounded-full absolute top-0 left-0 shadow-md ${darkMode ? 'ml-5 bg-yellow-500' : 'ml-0'} transition-all duration-300 cursor-pointer`}></div>
            </div>
        
          
      )      
    },
  ];

  return (
    <div className={`flex h-[152vh] py-9 px-20 ${darkMode ? 'dark' : 'bg-[#f2f2f2] text-black'}`}>

        <div className={`flex flex-col py-5 ${darkMode ? 'bg-gray-800' : 'bg-[#f2f2f2]'} w-[300px] rounded-lg`}>
            <svg width="38" height="10" viewBox="0 0 38 8" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="4" cy="4" r="4" fill="#EC4444"/><circle cx="19" cy="4" r="4" fill="#ECBD44"/><circle cx="34" cy="4" r="4" fill="#44EC55"/>
            </svg>

            {/* --- profile --- */}
            <div className={`flex items-center mt-11 ${darkMode ? 'bg-gray-700' : 'bg-white'} px-2 py-3 rounded-sm`}>
              <Image src={assets.profile.src} alt="" className="w-12 h-12 rounded-full" width={12} height={12} unoptimized/>
              <div className="ml-3">
                <h1 className='font-bold text-[16px]'>Abdisamad Abass</h1>
                <p className={`font-medium text-[14px] ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>Student</p>
              </div>
            </div>

            {/* --- dashboard content --- */}
            <div className='mt-7 flex flex-col gap-3'>
              {features.map((feature, index) => (
                <div key={index} onClick={() => setActive(index)} className={`flex items-center gap-3 px-5 py-3 ${active === index ? 'text-white bg-gradient-to-b from-[#172B85] to-[#559BED] rounded-md' : `hover:${darkMode ? 'bg-gray-700' : 'bg-gray-200'} text-[16px]`}`}>
                  
                    {feature.icon} 
                    {feature.text} 
                    <span>{feature.mode}</span>
                </div>
              ))}
            </div>

            {/* -- bottom -- */}
            <div className='px-5 mt-auto'>
              <p className={`flex items-center gap-5 text-[16px] text-[#0A0A1F] ${darkMode ? 'text-white ' : 'text-black'}`}><svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8.19996 10.5652C9.28445 10.5652 10.1636 9.64755 10.1636 8.51553C10.1636 7.38351 9.28445 6.46582 8.19996 6.46582C7.11548 6.46582 6.23633 7.38351 6.23633 8.51553C6.23633 9.64755 7.11548 10.5652 8.19996 10.5652Z" stroke={darkMode ? 'white' : 'black'} strokeWidth="1.3" strokeLinecap="round" strokeLinejoin="round"/>
                    <path d="M13.0436 10.5653C12.9565 10.7714 12.9305 11 12.969 11.2216C13.0075 11.4433 13.1087 11.6478 13.2596 11.8088L13.2989 11.8498C13.4206 11.9767 13.5172 12.1274 13.5831 12.2933C13.6489 12.4592 13.6828 12.637 13.6828 12.8166C13.6828 12.9961 13.6489 13.174 13.5831 13.3398C13.5172 13.5057 13.4206 13.6564 13.2989 13.7833C13.1773 13.9104 13.033 14.0112 12.874 14.08C12.7151 14.1487 12.5448 14.1841 12.3727 14.1841C12.2007 14.1841 12.0303 14.1487 11.8714 14.08C11.7125 14.0112 11.5681 13.9104 11.4465 13.7833L11.4073 13.7424C11.253 13.5848 11.0571 13.4792 10.8447 13.439C10.6324 13.3988 10.4134 13.4259 10.216 13.5169C10.0224 13.6035 9.8573 13.7473 9.741 13.9306C9.6247 14.1139 9.56229 14.3287 9.56145 14.5486V14.6647C9.56145 15.0271 9.42353 15.3747 9.17803 15.631C8.93253 15.8872 8.59956 16.0312 8.25236 16.0312C7.90517 16.0312 7.5722 15.8872 7.3267 15.631C7.08119 15.3747 6.94327 15.0271 6.94327 14.6647V14.6032C6.9382 14.3771 6.86808 14.1578 6.74201 13.9738C6.61594 13.7898 6.43975 13.6496 6.23636 13.5715C6.03894 13.4806 5.81995 13.4535 5.60761 13.4937C5.39528 13.5338 5.19935 13.6395 5.04509 13.797L5.00582 13.838C4.88424 13.9651 4.73986 14.0658 4.58094 14.1346C4.42202 14.2034 4.25167 14.2388 4.07964 14.2388C3.9076 14.2388 3.73725 14.2034 3.57833 14.1346C3.41941 14.0658 3.27503 13.9651 3.15345 13.838C3.03174 13.7111 2.93518 13.5604 2.8693 13.3945C2.80342 13.2286 2.76952 13.0508 2.76952 12.8712C2.76952 12.6917 2.80342 12.5138 2.8693 12.3479C2.93518 12.1821 3.03174 12.0314 3.15345 11.9044L3.19273 11.8635C3.34362 11.7024 3.44485 11.4979 3.48335 11.2763C3.52185 11.0546 3.49586 10.826 3.40873 10.62C3.32576 10.4179 3.18799 10.2455 3.01238 10.1241C2.83677 10.0027 2.63099 9.9376 2.42036 9.93673H2.30909C1.9619 9.93673 1.62893 9.79276 1.38342 9.5365C1.13792 9.28023 1 8.93267 1 8.57026C1 8.20784 1.13792 7.86028 1.38342 7.60401C1.62893 7.34775 1.9619 7.20378 2.30909 7.20378H2.368C2.58465 7.19849 2.79477 7.12529 2.97103 6.9937C3.1473 6.8621 3.28156 6.67819 3.35636 6.46589C3.44349 6.25981 3.46948 6.03122 3.43098 5.80958C3.39249 5.58794 3.29126 5.38342 3.14036 5.2224L3.10109 5.1814C2.97938 5.0545 2.88282 4.90379 2.81694 4.7379C2.75106 4.57202 2.71715 4.3942 2.71715 4.21463C2.71715 4.03505 2.75106 3.85724 2.81694 3.69135C2.88282 3.52546 2.97938 3.37476 3.10109 3.24785C3.22267 3.1208 3.36705 3.02001 3.52597 2.95124C3.68489 2.88247 3.85524 2.84708 4.02727 2.84708C4.19931 2.84708 4.36966 2.88247 4.52858 2.95124C4.6875 3.02001 4.83188 3.1208 4.95345 3.24785L4.99273 3.28884C5.14699 3.44635 5.34292 3.55201 5.55525 3.5922C5.76758 3.63239 5.98658 3.60526 6.184 3.51431H6.23636C6.42996 3.4277 6.59507 3.28389 6.71136 3.10059C6.82766 2.91728 6.89007 2.70248 6.89091 2.48262V2.36647C6.89091 2.00406 7.02883 1.65649 7.27433 1.40023C7.51984 1.14397 7.85281 1 8.2 1C8.54719 1 8.88016 1.14397 9.12567 1.40023C9.37117 1.65649 9.50909 2.00406 9.50909 2.36647V2.42796C9.50993 2.64782 9.57234 2.86262 9.68864 3.04593C9.80493 3.22923 9.97004 3.37304 10.1636 3.45965C10.3611 3.5506 10.5801 3.57773 10.7924 3.53754C11.0047 3.49735 11.2006 3.39169 11.3549 3.23418L11.3942 3.19319C11.5158 3.06614 11.6601 2.96535 11.8191 2.89658C11.978 2.82781 12.1483 2.79242 12.3204 2.79242C12.4924 2.79242 12.6627 2.82781 12.8217 2.89658C12.9806 2.96535 13.125 3.06614 13.2465 3.19319C13.3683 3.3201 13.4648 3.4708 13.5307 3.63669C13.5966 3.80258 13.6305 3.98039 13.6305 4.15997C13.6305 4.33954 13.5966 4.51736 13.5307 4.68324C13.4648 4.84913 13.3683 4.99984 13.2465 5.12675L13.2073 5.16774C13.0564 5.32876 12.9552 5.53328 12.9167 5.75492C12.8782 5.97656 12.9041 6.20515 12.9913 6.41123V6.46589C13.0742 6.66797 13.212 6.84031 13.3876 6.96171C13.5632 7.0831 13.769 7.14825 13.9796 7.14912H14.0909C14.4381 7.14912 14.7711 7.29309 15.0166 7.54936C15.2621 7.80562 15.4 8.15319 15.4 8.5156C15.4 8.87801 15.2621 9.22557 15.0166 9.48184C14.7711 9.7381 14.4381 9.88207 14.0909 9.88207H14.032C13.8214 9.88295 13.6156 9.94809 13.44 10.0695C13.2644 10.1909 13.1266 10.3632 13.0436 10.5653V10.5653Z" stroke={darkMode ? 'white' : 'black'} strokeWidth="1.3" strokeLinecap="round" strokeLinejoin="round"/>
                  </svg> Settings
              </p>
              <p className='flex items-center gap-5 mt-6 text-[16px] text-[#FD3838]'><svg width="19" height="14" viewBox="0 0 19 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7 1H3C1.89543 1 1 1.89543 1 3V11C1 12.1046 1.89543 13 3 13H7" stroke="#FD3838" strokeWidth="1.3" strokeLinecap="round"/>
                    <path d="M14 3L17.7472 6.8607C17.8225 6.9383 17.8225 7.0617 17.7472 7.1393L14 11" stroke="#FD3838" strokeWidth="1.3" strokeLinecap="round"/>
                  </svg> Log out
              </p>
            </div>
        </div>

        {/* ---- other pages --- */}
        <div className='w-full ml-4'>
            {children}
        </div>
    </div>
  )
}